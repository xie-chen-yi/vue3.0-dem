import{x as e}from"./index.4bc0a93a.js";import{d as t,r as n,e as s,o as r,i as a,a3 as l,b8 as o,j as c,b0 as u}from"./index.8d47259d.js";import"./vendor.3b1829c7.js";var i=t({name:"ImportExcel",emits:["success","error"],setup(t,{emit:r}){const a=n(null),l=n(!1);function o(t){if(!t||!t["!ref"])return[];const n=[],s=e.utils.decode_range(t["!ref"]),r=s.s.r;for(let a=s.s.c;a<=s.e.c;++a){const s=t[e.utils.encode_cell({c:a,r:r})];let l="UNKNOWN "+a;s&&s.t&&(l=e.utils.format_cell(s)),n.push(l)}return n}function c(t){return l.value=!0,new Promise(((n,s)=>{const a=new FileReader;a.onload=async t=>{try{const s=t.target&&t.target.result,a=function(t){const n=[];for(const s of t.SheetNames){const r=t.Sheets[s],a=o(r),l=e.utils.sheet_to_json(r);n.push({header:a,results:l,meta:{sheetName:s}})}return n}(e.read(s,{type:"array"}));r("success",a),n("")}catch(a){s(a),r("error")}finally{l.value=!1}},a.readAsArrayBuffer(t)}))}return{handleUpload:function(){const e=s(a);e&&e.click()},handleInputClick:function(e){const t=e&&e.target.files,n=t&&t[0];n&&async function(e){const t=s(a);t&&(t.value=""),await c(e)}(n)},inputRef:a}}});i.render=function(e,t,n,s,i,d){return r(),a("div",null,[l(c("input",{ref:"inputRef",type:"file",accept:".xlsx, .xls",onChange:t[1]||(t[1]=(...t)=>e.handleInputClick&&e.handleInputClick(...t))},null,544),[[o,!1]]),c("div",{onClick:t[2]||(t[2]=(...t)=>e.handleUpload&&e.handleUpload(...t))},[u(e.$slots,"default")])])};export default i;
